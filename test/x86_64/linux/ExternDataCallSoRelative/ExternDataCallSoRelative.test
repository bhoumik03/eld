#--ExternDataCallSoRelative.test-------Shared--#
#BEGIN_COMMENT
#Verifies non-preemptible data via GOT in a shared object uses RELATIVE relocations
#END_COMMENT
#START_TEST
RUN: %clang %clangopts -fPIC -c %p/Inputs/so_rel_defs.c -o %t.so_rel_defs.o
RUN: %clang %clangopts -fPIC -c %p/Inputs/so_rel_use.c -o %t.so_rel_use.o
RUN: %link %linkopts -shared -o %t.librel.so %t.so_rel_defs.o %t.so_rel_use.o
RUN: %clang %clangopts -c %p/Inputs/so_rel_main.c -o %t.so_rel_main.o
RUN: %link %linkopts -o %t.so_rel.out %t.so_rel_main.o %t.librel.so
RUN: %t.so_rel.out; echo $? | %filecheck %s --check-prefix=EXITCODE
EXITCODE: 19
